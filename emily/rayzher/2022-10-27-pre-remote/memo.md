## **明日需完成**

### _每個 iteration 都需更改原始 CSV 檔案內容_

> 下班前演示給戴婷時常常已經轉拋但技能中間被我中斷，造成轉拋產生的系統單號沒有記錄到外部原始 CSV 檔案中。
> 應該想辦法防止這種現象，即使技能被中途打斷，有轉拋過產生的系統單號都應該已經寫到外部原始 CSV 檔案中。

- 每個 iteration 結尾都要有 repo2dir(匯出工作資料夾)
- 優缺：整個流程完成時間變長，但是中途即使中斷技能也可以使用原本的 CSV 再執行運作下去

### _例外：原始到廠日期_

> 客戶資料沒有提供自己也忘了做上去、自己 key in 日期不正確、單身欄位沒調整過，這三種錯誤在下班前演示時輪流發生。
> 應該都要能夠產生對應的錯誤訊息，正確的中止目前的 interation、跳到下一次 iteration 中。

- 兩種例外情況
  - 原始 CSV 檔案沒提供
    - 可以在迴圈一開始時，做一個 validation 專用的步驟去檢查
      - 有兩個迴圈，一個 for apmp200、另一個 for apmt540，所以各自有 validation 而且只檢查自己需要使用的欄位資料 (不做任何多餘檢查)
      - 只檢查 for 自己迴圈本身所需欄位是因為要搭配 validation fail 時需填入對應的欄位 (apmp200 or apmt540)
  - 單身填寫時出現 warning 彈窗
    - 日期填入、tab 兩次後，侷限畫面中心檢查是否有 warning 彈窗(使用左上 tt icon)
      - 若有，Copy Field 錯誤訊息填入 main.csv、return 結束此 DA module
      - tab 與輸入日期部分沒有滑鼠移動、點擊之類的操作，先實驗看看這些動作是否會影響到彈出 warning 視窗
        - 如果不影響，就可以在 tab、輸入 的操作都結束以後去檢查有無彈出視窗
          - 這樣檢查只需要一次，對整個 skill 耗時增加不大
        - 如果有影響，就只能在每次 tab 之後做檢查
          - 這樣檢查會比較多次，可能要縮短 waitFor 時間

### _Validation_

- apmp200 與 apmt540 各自迴圈開頭應該都增加一個 validation 專用的步驟。
- 循環中 validation 步驟通過時讓其產生一個通行證 (例如 apmp200_pass.txt = true)，讓循環中其他步驟依此條件執行

### _CSV 空白資料問題_

- 會造成 apmp200 篩選到所有單號
- 應該在 main 轉 output 時把空白資料部分排除
- 空白格字串處理
  - trim，但如果非字串而是 null 或 undefined 怎辦

### _關於已完成資料的 CSV (外部、這次技能) 的檔案與變數名稱_

- script 之後的匯入檔案(optional)內容有問題
  - 檔名應該改成 currentFinish.csv
  - 下一個匯入應該刪除
- 隨後的 DA 內容
  - variable finish 應該改成 currentFinish 更有意義
  - try 裡面的 readCSV 不應該讀有日期的 finish 檔案，而是直接讀取 currentFinish.csv
  - newFinish 應該改成 thisSkillFinish
- 從更早把這次技能完成的資料分出來的地方開始就要使用比較有意義的變數或檔案名稱
- CSV 檔名包含日期的部分應該留在外部，基本上匯入時就要轉回無日期的檔名

### _檔案匯出位置_

- 總共有匯出兩個檔案
  - 原始 CSV
  - 已完成資料 CSV
- repo2der(匯出工作資料夾) 會在安裝部分產生選項供下載時指定資料夾位址
  - 但是問題是有些需要一同作修改的部分，沒有智能到會自己跟著更改
  - 或許只是跟匯入部分有呼應而已？因為其他部分不能夠直接與工作資料夾外的地方互動
    - 如果是這樣的話
      - 匯入、匯出一組使用相同路徑/檔案 -> 檔案會不停覆蓋
      - 匯入、繪出一組使用不同路徑/檔案 -> 檔案不會覆蓋，每次執行技能檔案數量都會增加
    - 需要跟客戶說明清楚，讓對方能夠依照他們自己的需求正確安裝

### _閒置時間已超過_

- 今天最後掩飾 apmt540 時出現閒置時間已超過彈窗
  - 看錄影黨是 apmp200 閒置過久造成
    - 所以操作 apmt540 時，其他沒有操作的功能介面應該都關閉，這已經是在正常流程能達到的情況

### _取得 import 的檔案_

- 設定打開確認就有

### _與其用 Powershell 刪除_

- 不如使用改名、或執行腳本
  - 不用開啟模組，所以速度會快很多
  - 改名不能使用文件變數
    - 可惜，不然可以把每次迴圈結果記錄下來
