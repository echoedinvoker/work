## **Question**

![Alt original and result](pic/bandicam%202022-10-29%2023-06-05-341.jpg)

- As shown above, we often need to merge the result of the processing back into the **original CSV file**.

## **Principle**

![Alt json](pic/bandicam%202022-10-29%2023-19-32-640.jpg)

- The CSV import should be **converted to a JSON** file in the working folder.
  - Any **data processing** and **data changes** should be based on **JSON** files.
  - The **CSV file** is generated using the **current JSON** file only if it needs to be **looped** or **exported** externally.
    - Try not to convert to CSV as much as possible. **Mainly use JSON**.
    - **CSV** generated in the middle of skill should be used as soon as it is generated and **discarded immediately after use**, there should not be any time continuity.
- Based on the above principles, it may never be necessary to convert the results generated by Emily's processing of the raw data into the CSV file such as in first figure.

## **Code**

![Alt code](pic/bandicam%202022-10-29%2023-57-09-829.jpg)

- Although **mutant variables** should be avoided as much as possible, the **mutant** original in this case makes the problem much simpler.

## **Final JSON**

![Alt json result](pic/bandicam%202022-10-29%2023-57-31-794.jpg)

- above result has following features:

  - If there is any part of the result data that is already in original, it will be **overwritten**.
  - If there is any part of the result data that is not in original, it will be **append** into original.
  - **Keep** the parts of the original that are not processed.

- Even for a simple update of the original data, **better use the codes above instead of overriding**.
  - This will **reduce unnecessary risks**, such as users adding data to the original while the skill is still running.
  - However, **not all risks can be avoided**, for example, when the skill are written to outside CSV file, the user still has the original CSV file open.

## **Code Update!**

![alt](pic/bandicam%202022-10-31%2002-44-11-802.jpg)

- Use fewer codes to complete same thing.
  - However, note that the **result** file must **cover all properties/fields** of the source data.
